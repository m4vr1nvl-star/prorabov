# –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–≤–æ–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π - HTTP/2 Fix

## üìù –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. next.config.mjs
```diff
- compress: true,
+ // compress –æ—Ç–∫–ª—é—á–µ–Ω - Vercel –∏—Å–ø–æ–ª—å–∑—É–µ—Ç HTTP/2 —Å–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º —Å–∂–∞—Ç–∏–µ–º
+ compress: false,
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ!** –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ HTTP/2 –æ—à–∏–±–æ–∫.

---

### 2. vercel.json
**–£–¥–∞–ª–µ–Ω–æ:**
- ‚ùå `buildCommand: "npm run build"`
- ‚ùå `outputDirectory: ".next"`
- ‚ùå `framework: "nextjs"`
- ‚ùå –í–µ—Å—å –±–ª–æ–∫ `headers` (–¥—É–±–ª–∏—Ä–æ–≤–∞–ª next.config.mjs):
  - X-Content-Type-Options
  - X-Frame-Options
  - X-XSS-Protection
  - Referrer-Policy

**–ò–∑–º–µ–Ω–µ–Ω–æ:**
- Redirects —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç `has` —É—Å–ª–æ–≤–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ host
- –î–æ–±–∞–≤–ª–µ–Ω redirect –¥–ª—è www.raznorabochie-sochi.ru

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "redirects": [
    {
      "source": "/:path(.*)",
      "has": [{"type": "host", "value": "raznorabochie-sochi.ru"}],
      "destination": "https://prorabov.ru/:path*",
      "permanent": true
    },
    {
      "source": "/:path(.*)",
      "has": [{"type": "host", "value": "www.raznorabochie-sochi.ru"}],
      "destination": "https://prorabov.ru/:path*",
      "permanent": true
    }
  ]
}
```

---

### 3. pages/_document.js
**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
```javascript
{/* Preconnect –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ */}
<link rel="preconnect" href="https://wa.me" crossOrigin="anonymous" />
<link rel="preconnect" href="https://t.me" crossOrigin="anonymous" />
<link rel="dns-prefetch" href="https://wa.me" />
<link rel="dns-prefetch" href="https://t.me" />
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ë—Ä–∞—É–∑–µ—Ä –∑–∞—Ä–∞–Ω–µ–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç TCP/TLS —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –ë—ã—Å—Ç—Ä–µ–µ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è WhatsApp/Telegram —Å—Å—ã–ª–∫–∏
- dns-prefetch –æ—Å—Ç–∞–µ—Ç—Å—è –∫–∞–∫ fallback

---

## üìö –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

1. **VERCEL_HTTP2_FIX.md** (240 —Å—Ç—Ä–æ–∫)
   - –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
   - –û–±—ä—è—Å–Ω–µ–Ω–∏–µ HTTP/2 –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π
   - –ü–æ—á–µ–º—É compress –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å Vercel
   - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ—Ç–ª–∞–¥–∫–µ

2. **DEPLOYMENT_CHECKLIST.md** (200 —Å—Ç—Ä–æ–∫)
   - –ü–æ–ª–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
   - –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –æ—Å—Ç–∞–ª–∏—Å—å

3. **HTTP2_FIX_SUMMARY.md** (80 —Å—Ç—Ä–æ–∫)
   - –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ/–ø–æ—Å–ª–µ
   - –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

4. **README_HTTP2_FIX.md** (220 —Å—Ç—Ä–æ–∫)
   - Quick reference
   - Best practices –¥–ª—è Vercel + Next.js
   - –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
   - –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

5. **COMMIT_MESSAGE.txt**
   - –ì–æ—Ç–æ–≤—ã–π commit message
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

6. **FINAL_CHANGES_SUMMARY.md** (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
   - –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–≤–æ–¥–∫–∞ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

- ‚úÖ `npm run build` - —É—Å–ø–µ—à–Ω–æ (–≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã SSG ‚óè)
- ‚úÖ `npm run lint` - –±–µ–∑ –æ—à–∏–±–æ–∫ (‚úî No ESLint warnings or errors)
- ‚úÖ Dev server –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è (Ready in ~2s)
- ‚úÖ Bundle size –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω (~85 KB First Load JS)
- ‚úÖ .gitignore –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (.next –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è)
- ‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –≤–µ—Ç–∫–µ `fix/vercel-http2-prorabov`

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
```
‚è±Ô∏è  –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏: 6-10s (—Ç–∞–π–º–∞—É—Ç—ã)
üî¥ ERR_HTTP2_PING_FAILED
üî¥ ERR_CONNECTION_CLOSED
‚ùå –§–æ—Ä–º—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
üìâ Performance: 40-60
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
```
‚è±Ô∏è  –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏: 2-3s
‚úÖ –í—Å–µ —Ä–µ—Å—É—Ä—Å—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è (200 OK)
‚úÖ –ö–æ–Ω—Å–æ–ª—å —á–∏—Å—Ç–∞—è (0 –æ—à–∏–±–æ–∫)
‚úÖ –§–æ—Ä–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç (WhatsApp –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è)
üìà Performance: 85-95 (–æ–∂–∏–¥–∞–µ—Ç—Å—è)
```

---

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é!

### –°–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:

1. **Commit & Push:**
   ```bash
   git add next.config.mjs vercel.json pages/_document.js
   git add VERCEL_HTTP2_FIX.md DEPLOYMENT_CHECKLIST.md HTTP2_FIX_SUMMARY.md README_HTTP2_FIX.md
   git commit -F COMMIT_MESSAGE.txt
   git push origin fix/vercel-http2-prorabov
   ```

2. **Vercel –¥–µ–ø–ª–æ–π:**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –ø–æ—Å–ª–µ push
   - –°–ª–µ–¥–∏—Ç—å –∑–∞ Vercel Dashboard ‚Üí Deployments

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞:**
   - –°–ª–µ–¥–æ–≤–∞—Ç—å DEPLOYMENT_CHECKLIST.md
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å https://prorabov.ru –≤ –±—Ä–∞—É–∑–µ—Ä–µ
   - DevTools ‚Üí Console (0 –æ—à–∏–±–æ–∫)
   - DevTools ‚Üí Network (–≤—Å–µ 200, protocol "h2")
   - –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É ‚Üí WhatsApp –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å—Å—è

4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - Vercel Analytics ‚Üí –ø–µ—Ä–≤—ã–µ 24 —á–∞—Å–∞
   - Error Rate < 0.1%
   - Response Time < 200ms

---

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞ (Acceptance Criteria)

- ‚úÖ –í—Å–µ —Ä–µ—Å—É—Ä—Å—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –°–∞–π—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞ 2-3 —Å–µ–∫—É–Ω–¥—ã
- ‚úÖ –í—Å–µ —Ñ–æ—Ä–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- ‚úÖ –°–∞–π—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ prorabov.ru

**–í—Å–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –Ω–∞ Vercel.**

---

**–î–∞—Ç–∞:** 02.12.2024  
**–í–µ—Ç–∫–∞:** fix/vercel-http2-prorabov  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é  
**–ê–≤—Ç–æ—Ä:** CTO.new AI Agent
